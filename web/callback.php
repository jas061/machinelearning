<?php
$accessToken = getenv('LINE_CHANNEL_ACCESS_TOKEN');


//ユーザーからのメッセージ取得
$json_string = file_get_contents('php://input');
$jsonObj = json_decode($json_string);

$type = $jsonObj->{"events"}[0]->{"message"}->{"type"};
//メッセージ取得
$text = $jsonObj->{"events"}[0]->{"message"}->{"text"};
//ReplyToken取得
$replyToken = $jsonObj->{"events"}[0]->{"replyToken"};

//メッセージ以外のときは何も返さず終了
if($type != "text"){
	exit;
}

//返信データ作成
{"name":"機械学習の実践","created":"2017-10-24T12:47:04.700Z","intents":[{"intent":"粉末の部屋干しトップと液体部屋干しトップの違","created":"2017-10-30T07:55:52.099Z","updated":"2017-10-30T07:55:52.099Z","examples":[{"text":"粉末の「部屋干しトップ」と「液体部屋干しトップ」の違いを教えてください。","created":"2017-10-30T07:55:52.099Z","updated":"2017-10-30T07:55:52.099Z"}],"description":null},{"intent":"トッププラチナクリアと部屋干しトップ違い","created":"2017-10-30T07:53:46.625Z","updated":"2017-10-30T07:53:46.625Z","examples":[{"text":"「トップ プラチナクリア」と「部屋干しトップ」はどう違いますか。","created":"2017-10-30T07:53:46.625Z","updated":"2017-10-30T07:53:46.625Z"}],"description":null},{"intent":"こんにちは","created":"2017-10-30T08:24:12.083Z","updated":"2017-10-30T08:24:30.147Z","examples":[{"text":"やっほー","created":"2017-10-30T08:24:30.147Z","updated":"2017-10-30T08:24:30.147Z"},{"text":"ハロー","created":"2017-10-30T08:24:21.323Z","updated":"2017-10-30T08:24:21.323Z"},{"text":"hello","created":"2017-10-30T08:24:24.810Z","updated":"2017-10-30T08:24:24.810Z"},{"text":"こんにちは","created":"2017-10-30T08:24:14.263Z","updated":"2017-10-30T08:24:14.263Z"},{"text":"おはよう","created":"2017-10-30T08:24:15.914Z","updated":"2017-10-30T08:24:15.914Z"},{"text":"こんばんは","created":"2017-10-30T08:24:19.647Z","updated":"2017-10-30T08:24:19.647Z"}],"description":null},{"intent":"start_laundry","created":"2017-10-30T04:26:12.077Z","updated":"2017-10-30T04:26:12.077Z","examples":[{"text":"せんたく","created":"2017-10-30T04:26:12.077Z","updated":"2017-10-30T04:26:12.077Z"},{"text":"洗濯してくれる？","created":"2017-10-30T04:26:12.077Z","updated":"2017-10-30T04:26:12.077Z"},{"text":"スイッチオン","created":"2017-10-30T04:26:12.077Z","updated":"2017-10-30T04:26:12.077Z"},{"text":"洗濯して","created":"2017-10-30T04:26:12.077Z","updated":"2017-10-30T04:26:12.077Z"},{"text":"洗濯お願い","created":"2017-10-30T04:26:12.077Z","updated":"2017-10-30T04:26:12.077Z"}],"description":null},{"intent":"laundry_status","created":"2017-10-30T08:02:46.781Z","updated":"2017-10-30T08:02:51.854Z","examples":[{"text":"洗濯終わった？","created":"2017-10-30T08:02:51.854Z","updated":"2017-10-30T08:02:51.854Z"}],"description":null},{"intent":"さようなら","created":"2017-10-30T08:24:40.841Z","updated":"2017-10-30T08:24:56.599Z","examples":[{"text":"さよなら","created":"2017-10-30T08:24:44.493Z","updated":"2017-10-30T08:24:44.493Z"},{"text":"また明日","created":"2017-10-30T08:24:52.472Z","updated":"2017-10-30T08:24:52.472Z"},{"text":"またね","created":"2017-10-30T08:24:48.059Z","updated":"2017-10-30T08:24:48.059Z"},{"text":"バイバイ","created":"2017-10-30T08:24:46.238Z","updated":"2017-10-30T08:24:46.238Z"},{"text":"おやすみ","created":"2017-10-30T08:24:56.599Z","updated":"2017-10-30T08:24:56.599Z"},{"text":"さようなら","created":"2017-10-30T08:24:42.614Z","updated":"2017-10-30T08:24:42.614Z"}],"description":null},{"intent":"扱い店","created":"2017-10-30T04:31:59.481Z","updated":"2017-10-30T04:32:19.198Z","examples":[{"text":"どこで売ってますか？","created":"2017-10-30T04:32:04.529Z","updated":"2017-10-30T04:32:04.529Z"},{"text":"どこで買える？","created":"2017-10-30T04:32:12.971Z","updated":"2017-10-30T04:32:12.971Z"},{"text":"洗剤欲しいんだけど","created":"2017-10-30T04:32:19.198Z","updated":"2017-10-30T04:32:19.198Z"}],"description":null},{"intent":"ドラム式洗濯機","created":"2017-10-30T07:51:01.182Z","updated":"2017-10-30T07:51:06.302Z","examples":[{"text":"ドラム式洗濯機に使える洗剤はどれですか。","created":"2017-10-30T07:51:06.302Z","updated":"2017-10-30T07:51:06.302Z"}],"description":null},{"intent":"洗剤の種類","created":"2017-10-30T04:26:12.077Z","updated":"2017-10-30T04:26:12.077Z","examples":[{"text":"洗剤にはどのような種類の製品がありますか。何を選べばよいですか。","created":"2017-10-30T04:26:12.077Z","updated":"2017-10-30T04:26:12.077Z"},{"text":"洗剤の種類を教えて","created":"2017-10-30T04:26:12.077Z","updated":"2017-10-30T04:26:12.077Z"},{"text":"どの洗剤がいいの","created":"2017-10-30T04:26:12.077Z","updated":"2017-10-30T04:26:12.077Z"}],"description":null},{"intent":"ソフラン名前の由来","created":"2017-10-30T08:00:23.585Z","updated":"2017-10-30T08:00:45.909Z","examples":[{"text":"ソフランの名前の由来","created":"2017-10-30T08:00:45.909Z","updated":"2017-10-30T08:00:45.909Z"},{"text":"ソフランってどういう意味","created":"2017-10-30T08:00:40.145Z","updated":"2017-10-30T08:00:40.145Z"}],"description":null}],"updated":"2017-10-30T08:26:57.069Z","entities":[{"entity":"ライオンちゃんへの質問","values":[{"type":"synonyms","value":"ライオンちゃん","created":"2017-10-30T08:10:58.226Z","updated":"2017-10-30T08:11:04.224Z","metadata":null,"synonyms":["ライオンちゃん"]}],"created":"2017-10-30T08:10:54.763Z","updated":"2017-10-30T08:11:04.224Z","metadata":null,"description":null},{"entity":"yes","values":[{"type":"synonyms","value":"YES","created":"2017-10-30T04:26:02.135Z","updated":"2017-10-30T04:26:02.135Z","metadata":null,"synonyms":["うん","はい","ありがとう","YES","OK","お願い"]}],"created":"2017-10-30T04:26:02.135Z","updated":"2017-10-30T04:26:02.135Z","metadata":null,"description":null},{"entity":"気分","values":[{"type":"synonyms","value":"リラックス","created":"2017-10-30T07:37:34.571Z","updated":"2017-10-30T07:37:51.670Z","metadata":null,"synonyms":["リラックス","安らぎ","安心"]},{"type":"synonyms","value":"イライラ","created":"2017-10-30T07:38:05.516Z","updated":"2017-10-30T07:38:31.393Z","metadata":null,"synonyms":["イライラ","いらいら","いらつき","ストレス","不安"]},{"type":"synonyms","value":"幸せ","created":"2017-10-30T07:38:51.444Z","updated":"2017-10-30T07:39:57.313Z","metadata":null,"synonyms":["幸せ","ハッピー","最高","しあわせ"]},{"type":"synonyms","value":"悲しい","created":"2017-10-30T07:40:03.093Z","updated":"2017-10-30T07:40:24.967Z","metadata":null,"synonyms":["悲しい","寂しい","泣く","孤独"]}],"created":"2017-10-30T07:37:30.488Z","updated":"2017-10-30T07:40:24.967Z","metadata":null,"description":null},{"entity":"カテゴリ_衣類のケア","values":[{"type":"synonyms","value":"洗剤","created":"2017-10-30T04:26:02.135Z","updated":"2017-10-30T07:47:52.258Z","metadata":null,"synonyms":["洗剤","せんざい"]},{"type":"synonyms","value":"洗濯","created":"2017-10-30T07:47:59.739Z","updated":"2017-10-30T07:47:59.739Z","metadata":null,"synonyms":["洗濯","せんたく","お洗濯"]},{"type":"synonyms","value":"服","created":"2017-10-30T07:48:27.558Z","updated":"2017-10-30T07:48:59.472Z","metadata":null,"synonyms":["スカート","服","洋服","ズボン","衣類","衣料"]}],"created":"2017-10-30T04:26:02.135Z","updated":"2017-10-30T07:48:59.472Z","metadata":null,"description":null},{"entity":"no","values":[{"type":"synonyms","value":"NO","created":"2017-10-30T04:26:02.135Z","updated":"2017-10-30T04:26:02.135Z","metadata":null,"synonyms":["ううん","やめて","ダメ","だめ","いいえ","違う"]}],"created":"2017-10-30T04:26:02.135Z","updated":"2017-10-30T04:26:02.135Z","metadata":null,"description":null},{"entity":"laundry","values":[{"type":"synonyms","value":"洗濯","created":"2017-10-30T04:26:02.135Z","updated":"2017-10-30T04:26:02.135Z","metadata":null,"synonyms":["洗濯","せんたく","服洗う","服を洗う","ランドリー"]}],"created":"2017-10-30T04:26:02.135Z","updated":"2017-10-30T04:26:02.135Z","metadata":null,"description":null}],"language":"ja","metadata":{"api_version":{"major_version":"v1","minor_version":"2017-05-26"}},"description":"","dialog_nodes":[{"title":null,"output":{},"parent":"node_23_1509351083438","context":null,"created":"2017-10-28T03:19:14.033Z","updated":"2017-10-30T08:11:58.933Z","metadata":{"_customization":{"mcr":true}},"next_step":null,"conditions":"@カテゴリ_衣類のケア","description":null,"dialog_node":"node_1_1509160776157","previous_sibling":null},{"type":"response_condition","title":null,"output":{"text":{"values":["衣料用洗剤には一般衣料用とおしゃれ着洗いがあります。一般衣料用は粉末と液体があり、おしゃれ着用は液体です。これらには、白く仕上げる為に蛍光増白剤が入っているものや、きなりやパステルカラーの衣料に適した蛍光増白剤の入っていない洗剤があります。また、酵素や酸素系漂白剤、柔軟成分の入っている洗剤もありますので、目的に応じて選んでください。尚、洗濯前には衣料の取り扱い絵表示も必ず確認してください。衣料用洗剤の選び方はこちらをご覧ください。リンク先：http://www.lion.co.jp/ja/seihin/select/index01.htm"],"selection_policy":"sequential"}},"parent":"node_4_1509161827165","context":null,"created":"2017-10-28T03:37:19.385Z","updated":"2017-10-30T04:09:28.098Z","metadata":null,"next_step":null,"conditions":"","description":null,"dialog_node":"node_5_1509161861509","previous_sibling":null},{"title":null,"output":{"text":{"values":["それでは別の洗剤で洗いますか？"],"selection_policy":"sequential"}},"parent":"node_1_1509337381386","context":null,"created":"2017-10-30T04:24:17.316Z","updated":"2017-10-30T07:44:42.331Z","metadata":null,"next_step":{"behavior":"jump_to","selector":"user_input","dialog_node":"node_1_1509337381386"},"conditions":"@no","description":null,"dialog_node":"node_3_1509337456677","previous_sibling":"node_2_1509337438847"},{"title":null,"output":{"text":{"values":["わかりました。今日はどんな香りの気分ですか？"],"selection_policy":"sequential"}},"parent":"node_1_1509337381386","context":null,"created":"2017-10-30T04:23:59.256Z","updated":"2017-10-30T04:39:44.227Z","metadata":null,"next_step":null,"conditions":"@yes","description":null,"dialog_node":"node_2_1509337438847","previous_sibling":null},{"title":null,"output":{"text":{"values":["わかりました。またのご利用おまちしてます。"],"selection_policy":"sequential"}},"parent":"node_5_1509337957622","context":null,"created":"2017-10-30T04:39:17.405Z","updated":"2017-10-30T04:41:05.236Z","metadata":null,"next_step":null,"conditions":"@no","description":null,"dialog_node":"node_11_1509338357022","previous_sibling":"node_10_1509338353533"},{"title":null,"output":{"text":{"values":["わかりました。お店から1週間以内にお届けします。"],"selection_policy":"sequential"}},"parent":"node_5_1509337957622","context":null,"created":"2017-10-30T04:39:13.914Z","updated":"2017-10-30T04:40:44.612Z","metadata":null,"next_step":null,"conditions":"@yes","description":null,"dialog_node":"node_10_1509338353533","previous_sibling":null},{"type":"response_condition","title":null,"output":{"text":{"values":[],"selection_policy":"sequential"}},"parent":"ようこそ","context":null,"created":"2017-10-27T08:19:00.324Z","updated":"2017-10-28T03:16:24.165Z","metadata":null,"next_step":null,"conditions":"","description":null,"dialog_node":"node_2_1509092339966","previous_sibling":"node_1_1509092338607"},{"type":"response_condition","title":null,"output":{"text":{"values":["こんにちは。洗濯をはじめましょうか？ご質問があれば「ライオンちゃん」と話かけてください。"],"selection_policy":"sequential"}},"parent":"ようこそ","context":null,"created":"2017-10-27T08:18:59.081Z","updated":"2017-10-30T08:09:53.272Z","metadata":null,"next_step":null,"conditions":"","description":null,"dialog_node":"node_1_1509092338607","previous_sibling":null},{"type":"response_condition","title":null,"output":{"text":{"values":["<@気分>なんですね。それでは、ソフランを使って幸せな気分になりましょう♪"],"selection_policy":"sequential"}},"parent":"node_13_1509348882230","context":null,"created":"2017-10-30T07:40:54.188Z","updated":"2017-10-30T07:42:15.517Z","metadata":null,"next_step":null,"conditions":"@気分","description":null,"dialog_node":"node_14_1509349253764","previous_sibling":null},{"title":null,"output":{"text":{"values":["英語のＳｏｆｔ　ソフト＝柔軟から生まれた造語。「ソフトでランラン」な気分。"],"selection_policy":"sequential"}},"parent":"node_1_1509160776157","context":null,"created":"2017-10-30T08:00:59.418Z","updated":"2017-10-30T08:01:16.910Z","metadata":null,"next_step":null,"conditions":"#ソフラン名前の由来","description":null,"dialog_node":"node_20_1509350458926","previous_sibling":"node_19_1509350178910"},{"title":null,"output":{"text":{"values":["ドラム式洗濯機は泡立ちが多いと機械に不具合を生じる機種もありますので、泡立ちの低い「トッププラチナクリア」「部屋干しトップ除菌EX」「消臭ブルーダイヤ」、液体の「トップ NANOX」「トップ HYGIA」「香りつづくトップAroma　Ｐlus」「香りつづくトップ」「トップクリアリキッド」、ドライマークコースではおしゃれ着洗いの「アクロン」をおすすめします。"],"selection_policy":"sequential"}},"parent":"node_1_1509160776157","context":null,"created":"2017-10-30T07:51:45.099Z","updated":"2017-10-30T07:52:33.450Z","metadata":null,"next_step":null,"conditions":"#ドラム式洗濯機","description":null,"dialog_node":"node_16_1509349904455","previous_sibling":"node_4_1509161827165"},{"type":"response_condition","title":null,"output":{},"parent":"node_1_1509160776157","context":null,"created":"2017-10-28T03:35:34.890Z","updated":"2017-10-28T03:35:34.890Z","metadata":null,"next_step":null,"conditions":null,"description":null,"dialog_node":"node_3_1509161757020","previous_sibling":"node_2_1509161754919"},{"type":"response_condition","title":null,"output":{"text":{"values":["<@カテゴリ_衣類のケア>についてですね。どんなことが知りたいですか？"],"selection_policy":"sequential"}},"parent":"node_1_1509160776157","context":null,"created":"2017-10-28T03:35:33.415Z","updated":"2017-10-30T07:47:19.529Z","metadata":null,"next_step":null,"conditions":"@カテゴリ_衣類のケア","description":null,"dialog_node":"node_2_1509161754919","previous_sibling":"node_20_1509350458926"},{"title":null,"output":{"text":{"values":["酵素の種類が違います。「トップ プラチナクリア」は、繊維にからみついた汚れを落としやすくするプラチナーゼ（セルラーゼ）と、タンパク質分解酵素、脂質分解酵素の3種類の酵素を配合、さらにクリアプロテクト成分（CMCとPC）とともにガンコな汚れをすっきり落とすのに対して、「部屋干しトップ」は生乾きのニオイの原因となる汚れと菌の両方に働くダブル分解酵素に加え、除菌成分として酸素系漂白剤が配合されています。","「トップ プラチナクリア」は、繊維にからみついた汚れを落としやすくするプラチナーゼ（セルラーゼ）と、タンパク質分解酵素、脂質分解酵素の3種類の酵素を配合、さらにクリアプロテクト成分（CMCとPC）とともにガンコな汚れをすっきり落とすのに対して、「部屋干しトップ」は生乾きのニオイの原因となる汚れと菌の両方に働くダブル分解酵素に加え、除菌成分として酸素系漂白剤が配合されています。"],"selection_policy":"sequential"}},"parent":"node_1_1509160776157","context":null,"created":"2017-10-30T07:54:07.820Z","updated":"2017-10-30T07:55:03.797Z","metadata":null,"next_step":null,"conditions":"#トッププラチナクリアと部屋干しトップ違い","description":null,"dialog_node":"node_17_1509350047286","previous_sibling":"node_16_1509349904455"},{"title":null,"output":{"text":{"values":["粉末の「部屋干しトップ」はタンパク分解酵素と除菌成分（酸素系漂白剤）により、汚れと原因菌を除去します。一方、「液体部屋干しトップ」は新洗浄成分と抗菌成分の働きにより、汚れを除去し、原因菌の繁殖を抑制していやなニオイを防ぎます。"],"selection_policy":"sequential"}},"parent":"node_1_1509160776157","context":null,"created":"2017-10-30T07:56:19.330Z","updated":"2017-10-30T07:57:00.191Z","metadata":null,"next_step":null,"conditions":"#粉末の部屋干しトップと液体部屋干しトップの違","description":null,"dialog_node":"node_19_1509350178910","previous_sibling":"node_17_1509350047286"},{"title":null,"output":{},"parent":"node_1_1509160776157","context":null,"created":"2017-10-28T03:36:45.068Z","updated":"2017-10-30T04:04:36.070Z","metadata":{"_customization":{"mcr":true}},"next_step":null,"conditions":"#洗剤の種類","description":null,"dialog_node":"node_4_1509161827165","previous_sibling":null},{"title":null,"output":{},"parent":"node_2_1509337438847","context":null,"created":"2017-10-30T07:34:42.692Z","updated":"2017-10-30T07:40:54.690Z","metadata":{"_customization":{"mcr":true}},"next_step":null,"conditions":"@気分","description":null,"dialog_node":"node_13_1509348882230","previous_sibling":null},{"title":null,"output":{"text":{"values":["わかりました。この近くだと、ナフコ別府に取り扱いがあります。購入しますか？"],"selection_policy":"sequential"}},"parent":null,"context":null,"created":"2017-10-30T04:32:38.499Z","updated":"2017-10-30T08:07:08.414Z","metadata":null,"next_step":null,"conditions":"#扱い店","description":null,"dialog_node":"node_5_1509337957622","previous_sibling":"node_21_1509350578932"},{"title":null,"output":{"text":{"values":["ようこそ。お元気ですか？私はとっても元気です！"],"selection_policy":"sequential"}},"parent":null,"context":null,"created":"2017-10-30T08:25:06.118Z","updated":"2017-10-30T08:25:39.673Z","metadata":null,"next_step":null,"conditions":"#こんにちは","description":null,"dialog_node":"node_24_1509351905711","previous_sibling":"node_23_1509351083438"},{"title":null,"output":{"text":{"values":["まだです。あと5分で終わります。","今乾燥させています。","今たたんでいるところです。","はい。終わりましたよ＾＾"],"selection_policy":"random"}},"parent":null,"context":null,"created":"2017-10-30T08:02:59.309Z","updated":"2017-10-30T08:06:47.765Z","metadata":null,"next_step":null,"conditions":"#laundry_status","description":null,"dialog_node":"node_21_1509350578932","previous_sibling":"node_1_1509337381386"},{"title":null,"output":{"text":{"values":["さようなら。また明日笑顔で過ごせるよう、今日も一日を大切に過ごしましょう。"],"selection_policy":"sequential"}},"parent":null,"context":null,"created":"2017-10-30T08:25:42.881Z","updated":"2017-10-30T08:26:57.069Z","metadata":null,"next_step":null,"conditions":"#さようなら","description":null,"dialog_node":"node_25_1509351942495","previous_sibling":"node_24_1509351905711"},{"title":null,"output":{"text":{"values":["はーい！ご質問はなんでしょう？"],"selection_policy":"sequential"}},"parent":null,"context":null,"created":"2017-10-30T08:11:23.859Z","updated":"2017-10-30T08:11:50.449Z","metadata":null,"next_step":null,"conditions":"@ライオンちゃんへの質問","description":null,"dialog_node":"node_23_1509351083438","previous_sibling":"node_5_1509337957622"},{"title":null,"output":{"text":{"values":["分かりました(＾＾)今日はきれいなワンピースがあるので、おしゃれ着用のアクロンで洗濯しましょうか？","分かりました(＾＾)今日泥汚れが多いので、HYGIAで洗濯しましょうか？","分かりました(＾＾)今日は洗濯物が多いので、NANOXで洗濯しましょうか？"],"selection_policy":"random"}},"parent":null,"context":null,"created":"2017-10-30T04:23:01.827Z","updated":"2017-10-30T07:27:49.704Z","metadata":null,"next_step":null,"conditions":"#start_laundry","description":null,"dialog_node":"node_1_1509337381386","previous_sibling":"ようこそ"},{"title":"その他","output":{"text":{"values":["解釈できませんでした。申し訳ありませんが違う表現を試していただけますか。"],"selection_policy":"sequential"}},"parent":null,"context":null,"created":"2017-10-27T08:03:11.840Z","updated":"2017-10-30T04:02:32.239Z","metadata":null,"next_step":null,"conditions":"anything_else","description":null,"dialog_node":"その他","previous_sibling":"node_25_1509351942495"},{"title":"ようこそ","output":{},"parent":null,"context":null,"created":"2017-10-27T08:03:11.840Z","updated":"2017-10-27T08:18:59.847Z","metadata":{"_customization":{"mcr":true}},"next_step":null,"conditions":"welcome","description":null,"dialog_node":"ようこそ","previous_sibling":null}],"workspace_id":"7dde9eb8-30c6-4c0a-aa16-017ff2cec379","counterexamples":[],"learning_opt_out":false}

$post_data = [
	"replyToken" => $replyToken,
	"messages" => [$response_format_text]
	];

$ch = curl_init("https://api.line.me/v2/bot/message/reply");
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'POST');
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($post_data));
curl_setopt($ch, CURLOPT_HTTPHEADER, array(
    'Content-Type: application/json; charser=UTF-8',
    'Authorization: Bearer ' . $accessToken
    ));
$result = curl_exec($ch);
curl_close($ch);
